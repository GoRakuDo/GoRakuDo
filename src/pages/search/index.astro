---
import BaseLayout from '../../layouts/BaseLayout.astro';
import CategorySection from '../../components/search/CategorySection.astro';
import TagSection from '../../components/search/TagSection.astro';
import SearchSection from '../../components/search/SearchSection.astro';
import '../../styles/pages/search/search-index.css';

// URLパラメータの取得
const { searchParams } = Astro.url;
const initialQuery = searchParams.get('q') || '';
const initialCategory = searchParams.get('category') || '';
const initialTag = searchParams.get('tag') || '';

const seoData = {
  title: 'Cari - GoRakuDo',
  description: 'Cari melalui semua konten GoRakuDo (Docs/Tools/Pages).',
  keywords: ['cari', 'pembelajaran jepang', 'immersion', 'alat', 'dokumentasi'],
};
---

<BaseLayout
  title={seoData.title}
  description={seoData.description}
  keywords={seoData.keywords}
  pageType='website'
  lang='id'
>
  <main class='search-page'>
    <!-- 上層: カテゴリ閲覧 -->
    <section class='category-section' id='category-section'>
      <CategorySection
        initialCategory={initialCategory}
        initialQuery={initialQuery}
      />
    </section>

    <!-- 中層: タグ表示 -->
    <section class='tag-section' id='tag-section'>
      <TagSection initialTag={initialTag} initialQuery={initialQuery} />
    </section>

    <!-- 下層: 検索バー + 結果表示 -->
    <section class='search-section' id='search-section'>
      <SearchSection
        initialQuery={initialQuery}
        initialCategory={initialCategory}
        initialTag={initialTag}
      />
    </section>
  </main>
</BaseLayout>
