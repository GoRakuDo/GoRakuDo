---
import HeadSEO from "../components/public-components/HeadSEO.astro";
import BasicSEO from "../components/public-components/BasicSEO.astro";
import MetaManager from "../components/public-components/MetaManager.astro";
import "../styles/global.css";
import homepageOgImage from "../assets/images/Logo Discord.png";

export interface Props {
  // このレイアウトが受け取るプロパティを定義
  title: string;
  description: string;
  ogImage?: string;
  pageType?: "website" | "article";
  publishedDate?: string;
  // langプロパティを追加
  lang?: "id" | "ja";
  keywords?: string[];
  seoProperties?: {
    articleType?: string;
    learningStage?: string;
    searchIntent?: string;
  };
}

// propsを受け取ります
const { title, description, ogImage, pageType, publishedDate, lang, keywords, seoProperties } =
  Astro.props;
---

<!doctype html>
<!-- <html>タグのlang属性も動的に設定 -->
<html lang={lang || "id"}>
  <head>
    <!-- Basic HTML head elements -->
    <HeadSEO
      title={title}
      description={description}
      lang={lang || "id"}
      canonicalUrl={new URL(Astro.request.url).toString()}
      favicon="/favicon.svg"
    />

    <!-- SEO-specific meta tags -->
    <BasicSEO
      title={title}
      description={description}
      primaryKeywords={keywords || []}
      seoProperties={{
        articleType: seoProperties?.articleType || "guide",
        learningStage: seoProperties?.learningStage || "intermediate",
        searchIntent: seoProperties?.searchIntent || "informational"
      }}
      socialMedia={{
        openGraph: {
          type: pageType || "website",
          image: ogImage || homepageOgImage
        }
      }}
    />

    <!-- Performance and security optimization -->
    <MetaManager
      performanceOptimization={{
        preload: [
          { href: "/css/global.css", as: "style" }
        ]
      }}
      securityHeaders={{
        csp: "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'",
        hsts: "max-age=31536000; includeSubDomains; preload"
      }}
      analytics={{
        googleAnalytics: "GA_MEASUREMENT_ID"
      }}
    />

    <!-- スタイルシートの<link>タグは不要です。上のimport文がその役割を果たします。 -->
  </head>
  <body>
    <!-- 共通のページ構造（NavbarやFooterなど）をここに記述 -->

    <!-- この<slot />に、各ページのユニークなコンテンツが挿入されます -->
    <slot />

    <!-- 共通のスクリプトなどがあればここに配置 -->
  </body>
</html>
