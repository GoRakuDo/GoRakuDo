---
// ========== POST LAYOUT COMPONENT ==========
// Centralized layout management following ArticleLayout pattern
// All content sections are provided through named slots
import UnifiedSEO from '../components/UnifiedSEO.astro';
import Breadcrumb from '../components/common/Breadcrumb.astro';
import TableOfContents from '../components/content/TableOfContents.astro';

import Navbar from '../components/common/NavBar/Navbar.astro';
import BottomNavBar from '../components/common/NavBar/BottomNavBar.astro';

// Animation
import WaveAnimation from '../components/animations/WaveAnimation.astro';

// Global CSS
import '../styles/global.css';

export interface Props {
  title: string;
  description: string;
  publishedDate?: string;
  lang?: 'id' | 'ja';
  author?: string;
  tags?: string[];
  // Post-specific props
  post?:
    | import('astro:content').CollectionEntry<'docs'>
    | import('astro:content').CollectionEntry<'tool-articles'>;
  collectionMetadata?: {
    displayName: string;
    basePath: string;
  };
  headings?: { depth: number; slug: string; text: string }[];
  postActions?: boolean;
  // Featured image from ContentCollection
  featuredImage?: string;
  // Breadcrumb configuration
  breadcrumbConfig?: {
    currentPath?: string;
    showHome?: boolean;
    variant?: 'compact' | 'spacious' | 'minimal' | 'pill' | 'underline';
    showIcons?: boolean;
    ariaLabel?: string;
  };
  // Breadcrumb Schema統合
  breadcrumbSchema?: {
    '@context': 'https://schema.org';
    '@type': 'BreadcrumbList';
    itemListElement: Array<{
      '@type': 'ListItem';
      position: number;
      name: string;
      item: string;
    }>;
  };
  // FAQ Schema統合
  faqSchema?: {
    '@context': 'https://schema.org';
    '@type': 'FAQPage';
    mainEntity: Array<{
      '@type': 'Question';
      name: string;
      acceptedAnswer: {
        '@type': 'Answer';
        text: string;
      };
    }>;
  } | null;
}

const {
  title,
  description,
  publishedDate,
  lang = 'id',
  author,
  tags = [],
  headings,
  breadcrumbSchema,
  faqSchema,
  featuredImage,
} = Astro.props;
---

<!doctype html>
<html lang={lang}>
  <head>
    <UnifiedSEO
      title={title}
      description={description}
      keywords={tags}
      lang={lang}
      pageType='article'
      author={author}
      publishedDate={publishedDate}
      modifiedDate={publishedDate}
      image={featuredImage}
      breadcrumbSchema={breadcrumbSchema}
      faqSchema={faqSchema}
    />
  </head>
  <body>
    <!-- Navigation - 共通コンポーネント -->
    <Navbar />
    <BottomNavBar />

    <!-- Background Wave Animation - Optimized for Article Reading -->
    <WaveAnimation className='wave-canvas' backgroundLayer='darker' />

    <!-- Main Content -->
    <main
      class='content-page items-center justify-center w-full max-w-full flex flex-col'
      role='main'
      style='padding-top: 5rem;'
    >
      <div class='content-wrapper'>
        <div class='content-container'>
          <!-- Breadcrumb Navigation Slot -->
          <slot name='breadcrumb' />

          <!-- Article Header Slot -->
          <slot name='header' />

          <!-- Article Content Slot -->
          <slot name='content' />

          <!-- Post Actions Slot -->
          <slot name='actions' />

          <!-- Additional Footer Content Slot -->
          <slot name='footer' />
        </div>

        <!-- Sidebar Container -->
        <div class='sidebar-container'>
          <!-- Table of Contents Sidebar Slot -->
          <slot name='sidebar'>
            <!-- Default Table of Contents implementation -->
            {
              headings && headings.length > 0 && (
                <TableOfContents headings={headings} />
              )
            }
          </slot>

          <!-- Additional Sidebar Content Slot -->
          <slot name='additional-sidebar' />
        </div>
      </div>
    </main>
  </body>
</html>
