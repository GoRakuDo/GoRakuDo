---
// ========== POST LAYOUT COMPONENT ==========
// Centralized layout management following ArticleLayout pattern
// All content sections are provided through named slots
import Navbar from '../components/common/Navbar.astro';
import UnifiedSEO from '../components/UnifiedSEO.astro';
import Breadcrumb from '../components/common/Breadcrumb.astro';
import TableOfContents from '../components/content/TableOfContents.astro';
import WaveAnimation from '../components/animations/WaveAnimation.astro';

// Global CSS
import '../styles/global.css';

export interface Props {
  title: string;
  description: string;
  publishedDate?: string;
  lang?: 'id' | 'ja';
  author?: string;
  tags?: string[];
  // Post-specific props
  post?: import('astro:content').CollectionEntry<'docs'>;
  collectionMetadata?: {
    displayName: string;
    basePath: string;
  };
  headings?: { depth: number; slug: string; text: string }[];
  postActions?: boolean;
  // Breadcrumb configuration
  breadcrumbConfig?: {
    currentPath?: string;
    showHome?: boolean;
    variant?: 'compact' | 'spacious' | 'minimal' | 'pill' | 'underline';
    showIcons?: boolean;
    ariaLabel?: string;
  };
}

const {
  title,
  description,
  publishedDate,
  lang = 'id',
  author,
  tags = [],
  headings,
} = Astro.props;
---

<!doctype html>
<html lang={lang}>
  <head>
    <UnifiedSEO
      title={title}
      description={description}
      keywords={tags}
      lang={lang}
      pageType='article'
      author={author}
      publishedDate={publishedDate}
      modifiedDate={publishedDate}
    />
  </head>
  <body>
    <!-- Background Wave Animation -->
    <WaveAnimation
      className='wave-canvas'
      enableStars={true}
      starsCount={10}
      starsOpacity={0.5}
      starsAnimationDuration='3s'
      starsColor='oklch(0.8 0.35 296.9)'
      starsBrightness={1}
      starsSize={1.5}
      starsGlow={false}
      backgroundLayer='darker'
    />

    <!-- Navigation Bar -->
    <Navbar variant='default' theme='auto' />

    <!-- Main Content -->
    <main
      class='content-page items-center justify-center w-full max-w-full flex flex-col'
      role='main'
      style='padding-top: 5rem;'
    >
      <div class='content-wrapper'>
        <div class='content-container'>
          <!-- Breadcrumb Navigation Slot -->
          <slot name='breadcrumb' />

          <!-- Article Header Slot -->
          <slot name='header' />

          <!-- Article Content Slot -->
          <slot name='content' />

          <!-- Post Actions Slot -->
          <slot name='actions' />

          <!-- Additional Footer Content Slot -->
          <slot name='footer' />
        </div>

        <!-- Sidebar Container -->
        <div class='sidebar-container'>
          <!-- Table of Contents Sidebar Slot -->
          <slot name='sidebar'>
            <!-- Default Table of Contents implementation -->
            {
              headings && headings.length > 0 && (
                <TableOfContents headings={headings} />
              )
            }
          </slot>

          <!-- Additional Sidebar Content Slot -->
          <slot name='additional-sidebar' />
        </div>
      </div>
    </main>
  </body>
</html>
