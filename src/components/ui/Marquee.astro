---
interface Props {
  class?: string;
  reverse?: boolean;
  pauseOnHover?: boolean;
  vertical?: boolean;
  [key: string]: any;
}

const {
  class: className,
  reverse,
  pauseOnHover = false,
  vertical = false,
  ...props
} = Astro.props;
---

<div
  class:list={[
    'group flex overflow-hidden py-8 [--gap:1rem] [gap:var(--gap)]',
    vertical ? 'flex-col' : 'flex-row',
    vertical ? 'mask-gradient-vertical' : 'mask-gradient-horizontal',
    className,
  ]}
  {...props}
>
  {
    Array(2)
      .fill(0)
      .map(_ => (
        <div
          class:list={[
            'flex shrink-0 justify-around [gap:var(--gap)]',
            vertical
              ? 'flex-col items-center animate-marquee-vertical'
              : 'flex-row animate-marquee',
            {
              'pause-on-hover': pauseOnHover,
              'direction-reverse': reverse,
            },
          ]}
        >
          <slot />
        </div>
      ))
  }
</div>

<style>
  @keyframes marquee {
    from {
      transform: translateX(0);
    }

    to {
      transform: translateX(calc(-100% - var(--gap)));
    }
  }

  @keyframes marqueeVertical {
    from {
      transform: translateY(0);
    }

    to {
      transform: translateY(calc(-100% - var(--gap)));
    }
  }

  /* Core animations */
  .animate-marquee {
    animation: marquee var(--duration) linear infinite;
  }

  .animate-marquee-vertical {
    animation: marqueeVertical var(--duration) linear infinite;
  }

  /* Direction control */
  .direction-reverse {
    animation-direction: reverse;
  }

  /* Pause on hover */
  .group:hover .pause-on-hover {
    animation-play-state: paused;
  }

  /* Gradient Mask - Horizontal */
  .mask-gradient-horizontal {
    mask-image: linear-gradient(
      to right,
      transparent,
      black 5%,
      black 95%,
      transparent
    );
  }

  /* Gradient Mask - Vertical */
  .mask-gradient-vertical {
    mask-image: linear-gradient(
      to bottom,
      transparent,
      black 5%,
      black 95%,
      transparent
    );
  }
</style>
