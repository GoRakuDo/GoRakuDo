---
import { Image } from 'astro:assets';

interface Props {
  name: string;
  username: string;
  date: string;
  avatar: string;
  body: string;
  nameColor?: string;
  link?: string;
  attachment?: string;
  attachmentAlt?: string;
}

const {
  name,
  username,
  date,
  avatar,
  body,
  nameColor = '#dbdee1',
  link,
  attachment,
  attachmentAlt = 'Attachment',
} = Astro.props;
---

<div
  class='flex gap-4 p-5 rounded-2xl w-[85vw] sm:w-[350px] md:w-[450px] lg:w-[500px] h-auto md:h-full shrink-0 font-sans text-left bg-[#313338] shadow-lg hover:shadow-2xl hover:bg-[#2e3035] transition-all duration-300 border border-white/5 hover:border-[#4752c4]/50 hover:-translate-y-1'
>
  <!-- Avatar -->
  <div class='shrink-0 cursor-pointer mt-0.5'>
    <div
      class='w-10 h-10 rounded-full overflow-hidden bg-[#1e1f22] ring-2 ring-white/5 hover:opacity-80 transition-opacity relative group/avatar'
    >
      <Image
        src={avatar}
        alt={username}
        width={40}
        height={40}
        class='w-full h-full object-cover'
        loading='lazy'
      />
    </div>
  </div>

  <!-- Content -->
  <div class='flex-1 min-w-0 flex flex-col'>
    <!-- Header -->
    <div class='flex items-center gap-2 mb-1 shrink-0'>
      {
        link ? (
          <a
            href={link}
            target='_blank'
            rel='noopener noreferrer'
            class='font-medium hover:underline decoration-1 underline-offset-2 cursor-pointer text-[1rem] leading-5.5'
            style={`color:${nameColor}`}
          >
            {username}
          </a>
        ) : (
          <span
            class='font-medium hover:underline decoration-1 underline-offset-2 cursor-pointer text-[1rem] leading-5.5'
            style={`color:${nameColor}`}
          >
            {username}
          </span>
        )
      }
      <!-- Verified/Bot Badge (Optional - can be added via slot later if needed) -->
      <span
        class='text-[0.75rem] text-[#949ba4] font-medium ml-1 cursor-default'
      >
        {date}
      </span>
    </div>

    <!-- Body & Attachment Wrapper -->
    <div class='flex flex-col gap-4 flex-1'>
      <!-- Body Text -->
      {
        body && (
          <div class='text-[#dbdee1] text-[0.9375rem] leading-5.5 whitespace-pre-wrap wrap-break-word font-normal'>
            {body}
          </div>
        )
      }

      <!-- Attachment -->
      {
        attachment && (
          <div class='w-full mt-1 flex-1 flex flex-col'>
            <div class='rounded-xl overflow-hidden border border-white/10 shadow-sm bg-black/20 w-full relative aspect-auto md:aspect-video flex-1'>
              <Image
                src={attachment}
                alt={attachmentAlt}
                width={600}
                height={338}
                class='w-full h-auto max-h-[450px] md:absolute md:inset-0 md:h-full md:max-h-none object-cover object-top hover:scale-105 transition-transform duration-300 cursor-pointer'
              />
            </div>
          </div>
        )
      }
    </div>

    <!-- Extra Slot Content -->
    <slot name='attachment' />
    <slot name='reactions' />
  </div>
</div>
