---
// ========== ENHANCED TOOLS GRID SECTION ==========
// Tools-GridSection.astro - Áµ±Âêà„Åï„Çå„Åü„ÉÑ„Éº„É´„Ç∞„É™„ÉÉ„Éâ„Çª„ÇØ„Ç∑„Éß„É≥„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà
// ToolCard.astro„ÅÆÊ©üËÉΩ„ÇíÁµ±Âêà„Åó„ÄÅAstro„Éç„Ç§„ÉÜ„Ç£„Éñ„Ç¢„Éó„É≠„Éº„ÉÅ„ÅßÊúÄÈÅ©Âåñ

// ========== INLINE TYPE DEFINITIONS ==========
export type ToolAnimationType = 'scale' | 'slide' | 'fade';

export interface ToolInteractiveConfig {
  hasHoverEffect?: boolean;
  hasClickAction?: boolean;
  animationType?: ToolAnimationType;
}

export interface Tool {
  readonly id: string;
  readonly name: string;
  readonly description: string;
  readonly iconUrl: string;
  readonly color?: string;
  readonly link: string;
  readonly interactiveElements?: ToolInteractiveConfig;
}

export interface ToolCardProps extends Tool {
  // ToolÂûã„Çí„Åù„ÅÆ„Åæ„Åæ‰ΩøÁî®
}

export interface GridSectionProps {
  tools: ToolCardProps[];
  className?: string;
  title?: string;
  description?: string;
  showTitle?: boolean;
}

// ========== CONSTANTS & CONFIGURATION ==========
const DEFAULT_ANIMATION: ToolAnimationType = 'scale';
const GRID_BREAKPOINTS = {
  mobile: 1,
  tablet: 2,
  desktop: 3,
} as const;

const ANIMATION_CLASSES = {
  scale: 'animation-scale',
  slide: 'animation-slide',
  fade: 'animation-fade',
} as const;

// ========== UTILITY FUNCTIONS ==========
const getAnimationClass = (
  interactiveElements?: Tool['interactiveElements']
): string =>
  ANIMATION_CLASSES[interactiveElements?.animationType || DEFAULT_ANIMATION];

const validateTool = (tool: Tool): boolean =>
  !!(tool.id && tool.name && tool.description && tool.iconUrl && tool.link);

// ========== OPTIMIZED DATA PROCESSING ==========
const {
  tools = [],
  className = '',
  title = 'Learning Tools',
  description = 'Discover our comprehensive collection of language learning tools',
  showTitle = false,
} = Astro.props;

// „ÉÑ„Éº„É´„ÅÆÊ§úË®º„Å®„Éï„Ç£„É´„Çø„É™„É≥„Ç∞
const validTools: Tool[] = tools.filter(validateTool);
---

<section
  class={`npmnpm loading py-8 sm:py-12 lg:py-16 scroll-reveal ${className}`}
  aria-labelledby='tools-title'
  role='main'
  id='tools-main-content'
  transition:name='tools-section'
  data-lazy
>
  <div class='container px-4 sm:px-6 lg:px-8'>
    <!-- „ÉÑ„Éº„É´„Ç∞„É™„ÉÉ„Éâ -->
    <div
      class='tools-grid max-w-7xl mx-auto grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8 lg:gap-10 tools-migration-enabled'
      role='list'
      aria-label='Available learning tools'
    >
      {
        validTools.map(tool => (
          <div class='tool-grid-item' role='listitem'>
            <article class='tool-card-wrapper'>
              <a
                href={tool.link}
                class={`tool-card glassmorphism glassmorphism-card group tools-interactive-optimized ${getAnimationClass(tool.interactiveElements)}`}
                aria-labelledby={`tool-name-${tool.id}`}
                aria-describedby={`tool-desc-${tool.id}`}
                role='link'
                tabindex='0'
                aria-label={`Learn more about ${tool.name} tool`}
              >
                <header class='tool-card-header'>
                  <div class='tool-title-container'>
                    <div
                      class='tool-icon'
                      role='img'
                      aria-label={`${tool.name} tool icon`}
                    >
                      <img
                        src={tool.iconUrl}
                        alt={`${tool.name} tool icon`}
                        class='tool-icon-image'
                        loading='lazy'
                        decoding='async'
                      />
                    </div>
                    <h3 class='tool-name' id={`tool-name-${tool.id}`}>
                      {tool.name}
                    </h3>
                  </div>
                </header>
                <div class='tool-card-body'>
                  <p class='tool-description-card' id={`tool-desc-${tool.id}`}>
                    {tool.description}
                  </p>
                </div>
                <footer class='tool-card-footer'>
                  <span class='tool-cta-text'>Lihat Panduan</span>
                  <svg
                    class='tool-arrow'
                    width='16'
                    height='16'
                    viewBox='0 0 24 24'
                    fill='none'
                    stroke='currentColor'
                    stroke-width='2.5'
                    role='img'
                    aria-label='Arrow indicating link to tool guide'
                  >
                    <path d='M5 12h14M12 5l7 7-7 7' />
                  </svg>
                </footer>
              </a>
            </article>
          </div>
        ))
      }

      <!-- „Çπ„É≠„ÉÉ„ÉàÁî®„ÅÆ„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ -->
      <slot />
    </div>
  </div>
</section>

<style>
  /* ========== „ÉÑ„Éº„É´„Ç´„Éº„Éâ„Éô„Éº„Çπ„Çπ„Çø„Ç§„É´ ========== */
  .tool-card {
    display: block;
    padding: var(--spacing-6);
    border-radius: var(--border-radius-card);
  }

  .tool-card:focus {
    outline: 2px solid var(--clr-accent);
    outline-offset: 2px;
    box-shadow: 0 0 0 4px rgba(139, 93, 255, 0.3);
  }

  .tool-card:focus-visible {
    outline: 2px solid var(--clr-accent);
    outline-offset: 2px;
  }

  .tool-card-article {
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .tool-card-header {
    margin-bottom: var(--spacing-6);
  }

  .tool-title-container {
    display: flex;
    align-items: center;
    gap: var(--spacing-4);
  }

  .tool-icon {
    flex-shrink: 0;
    width: 3rem;
    height: 3rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 0.75rem;
    position: relative;
    overflow: hidden;
    transition: all var(--transition-speed) var(--transition-ease);
  }

  .tool-icon-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 0.25rem;
    transition: transform var(--transition-speed) var(--transition-ease);
  }

  .tool-card:hover .tool-icon {
    /* Background, border, and box-shadow removed for cleaner design */
  }

  .tool-card:hover .tool-icon-image {
    transform: scale(1.05);
  }

  /* Fallback for failed image loads */
  .tool-icon-image:not([src]),
  .tool-icon-image[src=''] {
    display: none;
  }

  .tool-icon::before {
    content: 'üîß';
    font-size: 1.25rem;
    display: none;
  }

  .tool-icon:has(.tool-icon-image:not([src]))::before,
  .tool-icon:has(.tool-icon-image[src=''])::before {
    display: block;
  }

  @media (min-width: 640px) {
    .tool-icon {
      width: 3.5rem;
      height: 3.5rem;
    }
  }

  .tool-card-body {
    flex-grow: 1;
    margin-bottom: var(--spacing-6);
    margin-top: 0;
  }

  .tool-name {
    font-size: var(--fs-h3);
    font-weight: 600;
    margin: 0;
    line-height: 1.25;
    color: var(--clr-text-primary);
    flex: 1;
  }

  @media (min-width: 640px) {
    .tool-name {
      font-size: 1.25rem;
    }

    .tool-title-container {
      gap: var(--spacing-5);
    }
  }

  @media (min-width: 768px) {
    .tool-title-container {
      gap: var(--spacing-6);
    }
  }

  .tool-description-card {
    font-size: var(--fs-sm);
    line-height: 1.6;
    opacity: 0.8;
    color: rgba(255, 255, 255, 0.7);
  }

  @media (min-width: 640px) {
    .tool-description-card {
      font-size: var(--fs-base);
    }
  }

  .tool-card-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-top: var(--spacing-4);
    border-top: 1px solid rgba(255, 255, 255, 0.15);
    position: relative;
  }

  .tool-card-footer::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.2),
      transparent
    );
  }

  .tool-cta-text {
    font-size: var(--fs-sm);
    font-weight: 500;
    color: rgba(139, 93, 255, 0.8);
  }

  .tool-arrow {
    width: 1rem;
    height: 1rem;
    color: rgba(255, 255, 255, 0.6);
    transition: transform var(--transition-speed) var(--transition-ease);
  }

  .group:hover .tool-arrow {
    transform: translateX(4px);
  }

  /* ========== „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÇØ„É©„Çπ ========== */
  .animation-scale:hover {
    transform: scale(1.02);
  }

  .animation-slide:hover {
    transform: translateX(4px);
  }

  .animation-fade:hover {
    opacity: 0.9;
  }

  /* ========== „Ç¢„ÇØ„Çª„Ç∑„Éì„É™„ÉÜ„Ç£ ========== */
  /* Screen reader only class */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  /* High contrast mode support */
  @media (prefers-contrast: high) {
    .tool-icon {
      /* Background, border, and backdrop-filter removed for cleaner design */
    }

    .tool-card:hover .tool-icon {
      /* Background and border removed for cleaner design */
    }

    .tool-name {
      color: #ffffff;
    }

    .tool-description-card {
      color: #e5e5e5;
    }

    .tool-title-container {
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      padding-bottom: var(--spacing-2);
    }
  }

  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    .scroll-reveal {
      transition: none;
    }

    .tool-card {
      transition: none;
    }

    .tool-card:hover {
      transform: none;
    }

    .animation-scale:hover,
    .animation-slide:hover,
    .animation-fade:hover {
      transform: none;
      opacity: 1;
    }

    .tool-arrow {
      transition: none;
    }

    .group:hover .tool-arrow {
      transform: none;
    }

    .tool-icon-image {
      transition: none;
    }

    .tool-card:hover .tool-icon-image {
      transform: none;
    }
  }

  /* Focus management for keyboard navigation */
  .tool-card:focus-visible {
    outline: 3px solid var(--clr-accent);
    outline-offset: 2px;
  }

  /* Ensure sufficient color contrast */
  .tool-cta-text {
    color: rgba(139, 93, 255, 0.9);
  }

  .tool-arrow {
    color: rgba(255, 255, 255, 0.8);
  }

  /* Screen reader improvements */
  .tool-card-wrapper {
    position: relative;
  }

  /* Ensure interactive elements are large enough */
  .tool-card {
    min-height: 44px;
    min-width: 44px;
  }

  /* Performance optimizations */
  .tool-icon {
    will-change: transform;
    transform: translateZ(0);
    contain: layout style;
  }
</style>
