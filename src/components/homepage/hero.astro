---
// src/components/homepage/hero.astro
interface Props {
  kicker?: string;
  marker?: string;
  titleLine1?: string;
  titleLine2?: string;
  description?: string;
  ctaPrimary?: string;
  ctaSecondary?: string;
  missionId?: string;
  navbarSelector?: string;
}

const {
  kicker = 'Belajar Bahasa Jepang?',
  marker = '#Go-IMMERSE',
  titleLine1 = 'Belajar Secara Alami,',
  titleLine2 = 'Kuasai Layaknya Penutur Asli.',
  description = 'Dimana bahasa Jepang tidak lagi diterjemahkan di kepala, <wbr>tetapi dipahami seperti bahasa ibuðŸ”¥',
  ctaPrimary = 'Mulai Perjalananmu',
  ctaSecondary = 'Gabung Komunitas',
  missionId = 'mission',
  navbarSelector = '.navbar',
} = Astro.props;
---

<section
  class='hero-section'
  data-mission-id={missionId}
  data-navbar-selector={navbarSelector}
  aria-label='Hero section'
  transition:name='hero-section'
>
  <div id='hero-content' class='hero-content' transition:name='hero-content'>
    <p
      class='hero-kicker'
      aria-label='Section kicker'
      transition:name='hero-kicker'
    >
      {kicker}
    </p>

    <h1 id='hero-title' class='hero-title' transition:name='hero-title'>
      <span
        class='hero-marker gold-marker'
        aria-label='Hero marker'
        transition:name='hero-marker'
      >
        {marker}
      </span>
      <span
        class='white-gradient-text title-line-1'
        transition:name='hero-title-line-1'
      >
        {titleLine1}
      </span>
      <span
        class='white-gradient-text title-line-2'
        transition:name='hero-title-line-2'
      >
        {titleLine2}
      </span>
    </h1>

    <p
      class='hero-description'
      transition:name='hero-description'
      set:html={description}
    />

    <div class='hero-buttons' transition:name='hero-buttons'>
      <button
        type='button'
        class='primary-button'
        data-action='scroll-to-mission'
        aria-label={ctaPrimary}
        transition:name='hero-primary-button'
      >
        <span class='button-text'>{ctaPrimary}</span>
        <svg
          class='button-icon'
          viewBox='0 0 24 24'
          fill='none'
          stroke='currentColor'
          stroke-width='2'
          stroke-linecap='round'
          stroke-linejoin='round'
          aria-hidden='true'
        >
          <path d='M5 12h14M12 5l7 7-7 7'></path>
        </svg>
      </button>

      <button
        type='button'
        class='secondary-button'
        data-action='open-discord'
        aria-label={ctaSecondary}
        transition:name='hero-secondary-button'
      >
        <span class='button-text secondary-text'>{ctaSecondary}</span>
        <svg
          class='button-icon secondary-icon'
          viewBox='0 0 24 24'
          xmlns='http://www.w3.org/2000/svg'
          aria-hidden='true'
        >
          <path
            d='M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z'
            fill='currentColor'></path>
        </svg>
      </button>
    </div>
  </div>
</section>

<script is:inline>
  (() => {
    const section = document.querySelector('[data-mission-id]');
    const cfg = {
      mission: section?.dataset?.missionId || 'mission',
      navbar: section?.dataset?.navbarSelector || '.navbar',
    };

    const reveal = () => {
      const el = document.querySelector('#hero-content');
      el && setTimeout(() => el.classList.add('hero-revealed'), 300);
    };

    const scroll = () => {
      const target = document.getElementById(cfg.mission);
      const nav = document.querySelector(cfg.navbar);
      if (target && nav) {
        const offset =
          target.getBoundingClientRect().top +
          window.pageYOffset -
          nav.offsetHeight -
          40;
        window.scrollTo({ top: offset, behavior: 'smooth' });
      } else if (target) {
        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    };

    document.addEventListener('click', e => {
      const btn = e.target?.closest?.('[data-action]');
      if (!btn) return;
      const actions = {
        'scroll-to-mission': scroll,
        'open-discord': () =>
          window.open('https://discord.gg/j8qmYPAGQh', '_blank'),
        'go-to-posts': () => (window.location.href = '/docs'),
      };
      actions[btn.dataset.action]?.();
    });

    document.readyState === 'loading'
      ? document.addEventListener('DOMContentLoaded', reveal)
      : reveal();
  })();
</script>
