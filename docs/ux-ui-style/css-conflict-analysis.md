# CSS競合分析レポート: tools-index.css vs global.css

## 概要
`tools-index.css`と`global.css`の間で発生している競合箇所を詳細に分析し、段階的な解決策を提案します。

## 1. 重大な競合箇所

### 1.1 CSS変数の重複定義
**競合レベル: 高**

#### 色変数の競合
| 変数名 | global.css | tools-index.css | 競合状況 |
|--------|------------|-----------------|----------|
| `--clr-accent` | `oklch(0.65 0.25 280)` | `#8b5cf6` | **重大** |
| `--clr-accent-dark` | `oklch(0.6 0.25 280)` | `#7b4def` | **重大** |
| `--clr-accent-glow-faint` | `oklch(0.65 0.25 280 / 0.05)` | `rgba(139, 92, 246, 0.05)` | **重大** |
| `--clr-accent-glow-medium` | `oklch(0.65 0.25 280 / 0.1)` | `rgba(139, 92, 246, 0.35)` | **重大** |
| `--clr-accent-glow-strong` | `oklch(0.65 0.25 280 / 0.2)` | `rgba(139, 92, 246, 0.7)` | **重大** |
| `--clr-text-primary` | `oklch(1 0 0)` | `#e5e5e5` | **重大** |
| `--clr-text-secondary` | `oklch(0.8 0 0)` | `#a3a3a3` | **重大** |
| `--clr-text-muted` | `oklch(0.67 0 0)` | `#b0b0b0` | **重大** |

#### 背景色の競合
| 変数名 | global.css | tools-index.css | 競合状況 |
|--------|------------|-----------------|----------|
| `--clr-bg` | 未定義 | `#111111` | **中程度** |
| `--clr-background` | `oklch(0.05 0 0)` | 未定義 | **中程度** |

### 1.2 スペーシング変数の競合
**競合レベル: 中**

| 変数名 | global.css | tools-index.css | 競合状況 |
|--------|------------|-----------------|----------|
| `--spacing-*` | 未定義 | 独自定義 | **中程度** |
| `--section-padding-y` | `clamp(80px, 10vw, 120px)` | `var(--spacing-8)` | **中程度** |

### 1.3 ボーダー半径の競合
**競合レベル: 中**

| 変数名 | global.css | tools-index.css | 競合状況 |
|--------|------------|-----------------|----------|
| `--border-radius-card` | `20px` | `1rem` | **中程度** |
| `--border-radius-pill` | `35px` | `9999px` | **中程度** |

## 2. 影響範囲の分析

### 2.1 視覚的影響
- **色の不一致**: OKLCH vs HEX値の違いにより、色の表示が異なる
- **スペーシングの不整合**: 異なるスペーシングシステムによるレイアウトの崩れ
- **ボーダー半径の違い**: カードの角丸が異なる

### 2.2 パフォーマンス影響
- **CSS変数の重複**: ブラウザが最後に読み込まれた値を優先
- **メモリ使用量**: 不要な変数定義によるメモリ消費

### 2.3 メンテナンス性
- **デザインシステムの分裂**: 統一されたデザインシステムの欠如
- **デバッグの困難**: どちらの変数が適用されているかの判断が困難

## 3. 段階的解決計画

### Phase 1: 低リスク修正 (即座に実行可能)
**目標**: 既存スタイルを壊さずに競合を解消

#### 3.1 tools-index.cssの変数名変更
```css
/* 変更前 */
--clr-accent: #8b5cf6;
--clr-accent-dark: #7b4def;

/* 変更後 */
--tools-clr-accent: #8b5cf6;
--tools-clr-accent-dark: #7b4def;
```

#### 3.2 グローバル変数の参照に変更
```css
/* 変更前 */
color: var(--clr-text-primary);

/* 変更後 */
color: var(--clr-text-primary, var(--tools-clr-text-primary));
```

### Phase 2: 中リスク修正 (テスト後実行)
**目標**: デザインシステムの統一

#### 3.3 OKLCH色空間への統一
```css
/* tools-index.cssをOKLCHに統一 */
--tools-clr-accent: oklch(0.65 0.25 280);
--tools-clr-accent-dark: oklch(0.6 0.25 280);
```

#### 3.4 スペーシングシステムの統一
```css
/* global.cssのスペーシングシステムを使用 */
--tools-spacing-1: var(--spacing-xs);
--tools-spacing-2: var(--spacing-sm);
```

### Phase 3: 高リスク修正 (慎重に実行)
**目標**: 完全な統合と最適化

#### 3.5 変数の完全統合
- tools-index.cssの独自変数を削除
- global.cssの変数を直接参照
- 不要なコードの削除

## 4. 推奨される即座の対応

### 4.1 緊急度: 高
1. **変数名の競合解消**: `--clr-*`変数の重複を即座に修正
2. **フォールバック値の追加**: 既存スタイルの保護

### 4.2 緊急度: 中
1. **スペーシングシステムの統一**: レイアウトの一貫性確保
2. **ボーダー半径の統一**: 視覚的一貫性の向上

### 4.3 緊急度: 低
1. **パフォーマンス最適化**: 不要な変数の削除
2. **ドキュメント化**: 今後の競合防止

## 5. テスト計画

### 5.1 視覚的回帰テスト
- [ ] ツールページの表示確認
- [ ] 他のページへの影響確認
- [ ] レスポンシブデザインの確認

### 5.2 パフォーマンステスト
- [ ] CSS読み込み時間の測定
- [ ] メモリ使用量の確認
- [ ] レンダリング性能の測定

### 5.3 アクセシビリティテスト
- [ ] 色のコントラスト比の確認
- [ ] フォーカス状態の確認
- [ ] スクリーンリーダーの動作確認

## 6. リスク評価

### 6.1 低リスク
- 変数名の変更（適切なフォールバック付き）
- コメントの追加・更新

### 6.2 中リスク
- 色空間の変更（OKLCHへの統一）
- スペーシングシステムの変更

### 6.3 高リスク
- 既存クラス名の変更
- アニメーションの変更
- レイアウト構造の変更

## 7. 次のステップ

1. **Phase 1の実装**: 変数名の競合解消
2. **テスト実行**: 視覚的回帰テストの実施
3. **Phase 2の計画**: デザインシステム統一の準備
4. **ドキュメント更新**: 変更内容の記録

---

**作成日**: 2024年12月19日  
**作成者**: Sally (UX Expert)  
**レビュー状況**: 要確認  
**次回更新予定**: Phase 1完了後
