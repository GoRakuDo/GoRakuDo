# CSS競合詳細カテゴリ分類 - global.css

**作成日**: 2024年12月19日  
**分析者**: Winston (Architect)  
**対象ファイル**: `src/styles/global.css`

## 1. 色変数競合の詳細分析

### 1.1 プライマリカラー（紫色）の重複

#### 競合グループ A: メインアクセントカラー
```css
/* 行10: 新システム */
--clr-accent: oklch(0.65 0.25 280);

/* 行28: レガシーシステム */
--color-accent-purple: oklch(0.65 0.25 280);

/* 行530-532: Tailwindテーマ */
--color-accent: oklch(65% 0.18 280);
```

**問題**: 同じ色を3つの異なる変数名で定義
**影響**: コンポーネント間での色の一貫性が保てない
**修正方針**: `--clr-accent`を標準とし、他をエイリアス化

#### 競合グループ B: ダークアクセントカラー
```css
/* 行11: 新システム */
--clr-accent-dark: oklch(0.6 0.25 280);

/* 行26: レガシーシステム */
--color-accent-dark: oklch(0.6 0.25 280);
```

**問題**: 同一値の重複定義
**修正方針**: 一つに統合

#### 競合グループ C: グロウ効果
```css
/* 行12-15: 新システム */
--clr-accent-glow-faint: oklch(0.65 0.25 280 / 0.05);
--clr-accent-glow-medium: oklch(0.65 0.25 280 / 0.1);
--clr-accent-glow-strong: oklch(0.65 0.25 280 / 0.2);
--clr-accent-shadow: oklch(0.65 0.25 280 / 0.4);

/* 行37-43: レガシーシステム（重複あり） */
--color-accent-purple-glow-faint: oklch(0.65 0.25 280 / 0.05);
--color-accent-purple-glow-medium: oklch(0.65 0.25 280 / 0.25);
--color-accent-purple-glow-strong: oklch(0.65 0.25 280 / 0.5);
--color-accent-glow-faint: oklch(0.65 0.25 280 / 0.05);  /* 重複！ */
--color-accent-glow-medium: oklch(0.65 0.25 280 / 0.1);
--color-accent-glow-strong: oklch(0.65 0.25 280 / 0.2);
--color-accent-shadow: oklch(0.65 0.25 280 / 0.4);
```

**問題**: 同一変数名の重複定義（行40-42）
**影響**: 後から定義された値が使用される（予期しない動作）

### 1.2 テキストカラーの重複

#### 競合グループ D: プライマリテキスト
```css
/* 行7: 新システム */
--clr-text-primary: oklch(1 0 0);

/* 行27: レガシーシステム */
--color-text-primary: oklch(1 0 0);

/* 行502: Tailwindテーマ */
--color-foreground: oklch(98% 0.002 270);
```

**問題**: 同じ白色を3つの異なる値で定義
**修正方針**: 一つの標準値を確立

#### 競合グループ E: セカンダリテキスト
```css
/* 行8: 新システム */
--clr-text-secondary: oklch(0.8 0 0);

/* 行30: レガシーシステム */
--color-text-secondary: oklch(0.8 0 0);

/* 行525-527: Tailwindテーマ */
--color-muted-foreground: oklch(65% 0.008 270);
```

## 2. フォント変数の重複分析

### 2.1 フォントファミリーの重複定義

```css
/* 行61: 最初の定義 */
--font-primary: 'Inter', sans-serif;

/* 行67-69: 中間定義（上書きされる） */
--font-family-base: 'Inter', 'Noto Sans JP', ...;

/* 行72-74: 最終定義（実際に使用される） */
--font-primary: 'Inter', system-ui, ...;
```

**問題**: 同一変数の3回定義
**影響**: 中間定義が無駄になり、コードが冗長

### 2.2 日本語フォントの重複

```css
/* 行63: 最初の定義 */
--font-jp: 'Yuji Syuku', serif;

/* 行75-76: 上書き定義 */
--font-jp: 'Yuji Syuku', 'Noto Sans JP', ...;
```

## 3. スペーシング・ボーダー変数の重複

### 3.1 ボーダーラディウスの重複

```css
/* 行87-89: レガシーシステム */
--border-radius-lg: 12px;
--border-radius-md: 8px;
--border-radius-sm: 4px;

/* 行565-568: Tailwindテーマ */
--radius-lg: 0.75rem;    /* 12px相当 */
--radius-md: 0.5rem;     /* 8px相当 */
--radius-sm: 0.25rem;    /* 4px相当 */
```

**問題**: 同じ値を異なる単位で定義
**修正方針**: rem単位に統一

## 4. レイヤー競合の詳細分析

### 4.1 非標準レイヤーの使用

```css
@layer critical { ... }    /* 行113 - 非標準 */
@layer base { ... }        /* 行653 - 標準 */
@layer components { ... }  /* 行893 - 標準 */
@layer utilities { ... }   /* 行979 - 標準 */
```

**問題**: `critical`レイヤーがTailwindの標準ではない
**影響**: ビルドツールでの予期しない動作の可能性

### 4.2 レイヤー内でのスタイル重複

#### ボタンスタイルの重複
```css
/* @layer base 内（行669-683） */
.primary-button, .secondary-button, .cta-button, ... {
  transition: transform var(--transition-speed) ease, ...;
}

/* @layer components 内（行962-975） */
@media (max-width: 480px) {
  .primary-button { @apply px-[24px] py-[12px] text-sm; }
  .secondary-button { @apply px-[24px] py-[10px] text-sm; }
}
```

## 5. メディアクエリの重複分析

### 5.1 同一ブレークポイントの重複

```css
/* 行883: 最初の定義 */
@media (max-width: 768px) {
  .cta-button, .docs-button { ... }
}

/* 行1597: 重複定義 */
@media (max-width: 768px) {
  .article-content ul, .article-content ol { ... }
}
```

**問題**: 同じメディアクエリが複数箇所に分散
**修正方針**: 一つのメディアクエリに統合

### 5.2 プリントスタイルの重複

```css
/* 行1491: 最初の定義 */
@media print {
  .btn-primary, .btn-secondary, ... { ... }
}

/* 行1632: 重複定義 */
@media print {
  .article-content ul, .article-content ol { ... }
}
```

## 6. アニメーション定義の重複

### 6.1 キーフレームの重複

```css
/* 行1825: twinkleアニメーション */
@keyframes twinkle {
  0%, 100% { opacity: 0.4; ... }
  25% { opacity: 0.6; ... }
  ...
}

/* 行649: アニメーション登録 */
--animate-twinkle: twinkle 3s infinite;
```

**問題**: アニメーション定義と使用箇所が分散
**修正方針**: アニメーション関連を一箇所に集約

## 7. 修正優先度の詳細マトリックス

| 競合ID | カテゴリ | 影響度 | 修正難易度 | 推定時間 | 優先度 |
|--------|----------|--------|------------|----------|--------|
| A1 | 色変数重複 | 高 | 中 | 30分 | P0 |
| A2 | グロウ効果重複 | 高 | 低 | 15分 | P0 |
| B1 | テキスト色重複 | 高 | 低 | 20分 | P0 |
| C1 | フォント重複 | 中 | 低 | 15分 | P1 |
| D1 | ボーダーラディウス重複 | 中 | 低 | 10分 | P1 |
| E1 | レイヤー競合 | 中 | 高 | 45分 | P1 |
| F1 | メディアクエリ重複 | 低 | 低 | 20分 | P2 |
| G1 | アニメーション重複 | 低 | 低 | 10分 | P2 |

## 8. 段階的修正計画（詳細版）

### Phase 1: 色変数の統合 (65分)
1. **グロウ効果の重複削除** (15分)
   - 行40-42の重複定義を削除
   - 一貫した命名規則の確立

2. **プライマリカラーの統合** (30分)
   - `--clr-accent`を標準として確立
   - 他をエイリアス化

3. **テキストカラーの統合** (20分)
   - 一つの標準値を確立
   - レガシー変数をエイリアス化

### Phase 2: 構造的改善 (70分)
1. **フォント変数の整理** (15分)
   - 重複定義の削除
   - フォールバックの最適化

2. **スペーシング変数の統一** (10分)
   - rem単位への統一
   - レガシー変数のエイリアス化

3. **レイヤー構造の最適化** (45分)
   - `critical`レイヤーの削除
   - レイヤー間の依存関係の整理

### Phase 3: 最適化 (30分)
1. **メディアクエリの統合** (20分)
   - 重複するメディアクエリをマージ
   - レスポンシブロジックの最適化

2. **アニメーションの整理** (10分)
   - 重複するキーフレームの統合
   - パフォーマンスの最適化

## 9. リスク軽減策

### 高リスク項目
- **色変数の変更**: 既存コンポーネントの色が変わる可能性
  - **軽減策**: 段階的移行、エイリアス変数の維持

### 中リスク項目
- **レイヤーの変更**: スタイルの優先順位が変わる可能性
  - **軽減策**: 十分なテスト、段階的移行

### 低リスク項目
- **メディアクエリの統合**: レイアウトの崩れの可能性
  - **軽減策**: レスポンシブテストの実施

## 10. 検証計画

### 各フェーズ完了後
1. **ビジュアルリグレッションテスト**
2. **レスポンシブデザインテスト**
3. **パフォーマンステスト**
4. **ブラウザ互換性テスト**

### 最終検証
1. **全ページの表示確認**
2. **コンポーネントの動作確認**
3. **パフォーマンス測定**
4. **ファイルサイズの比較**

---

**次のステップ**: Phase 1の修正開始（色変数の統合）
