# CSS競合分析レポート: Tool-IdIndex.css vs global.css

## 概要
このドキュメントは、`src/styles/tools/[tool]/Tool-IdIndex.css`と`src/styles/global.css`の間で発生しているCSS変数とスタイルの競合を詳細に分析し、段階的な解決策を提案します。

## 分析日時
2025年9月17日

## 1. 重大な競合（Critical Conflicts）

### 1.1 CSS変数の重複定義

#### 色変数の競合
| 変数名 | Tool-IdIndex.css | global.css | 競合レベル |
|--------|----------------|------------|------------|
| `--color-primary` | `oklch(65% 0.18 280)` | `oklch(0.65 0.25 280)` | 🔴 高 |
| `--color-text-primary` | `oklch(95% 0.01 270)` | `oklch(1 0 0)` | 🔴 高 |
| `--color-text-secondary` | `oklch(75% 0.01 270)` | `oklch(0.8 0 0)` | 🔴 高 |
| `--color-text-muted` | `oklch(70% 0.01 270)` | `oklch(0.67 0 0)` | 🔴 高 |

#### スペーシング変数の競合
| 変数名 | Tool-IdIndex.css | global.css | 競合レベル |
|--------|----------------|------------|------------|
| `--spacing-xs` | `0.25rem` | `0.25rem` | 🟢 一致 |
| `--spacing-sm` | `0.5rem` | `0.5rem` | 🟢 一致 |
| `--spacing-md` | `1rem` | `1rem` | 🟢 一致 |
| `--spacing-lg` | `1.5rem` | `1.5rem` | 🟢 一致 |
| `--spacing-xl` | `2rem` | `2rem` | 🟢 一致 |
| `--spacing-2xl` | `3rem` | `3rem` | 🟢 一致 |

#### ボーダー半径変数の競合
| 変数名 | Tool-IdIndex.css | global.css | 競合レベル |
|--------|----------------|------------|------------|
| `--radius-sm` | `0.5rem` | `0.25rem` | 🟡 中 |
| `--radius-md` | `0.75rem` | `0.5rem` | 🟡 中 |
| `--radius-lg` | `1rem` | `0.75rem` | 🟡 中 |
| `--radius-xl` | `1.5rem` | `1rem` | 🟡 中 |

#### フォントサイズ変数の競合
| 変数名 | Tool-IdIndex.css | global.css | 競合レベル |
|--------|----------------|------------|------------|
| `--font-size-xs` | `0.625rem` | `0.75rem` | 🟡 中 |
| `--font-size-sm` | `0.75rem` | `0.875rem` | 🟡 中 |
| `--font-size-base` | `0.875rem` | `1rem` | 🟡 中 |
| `--font-size-lg` | `1rem` | `1.125rem` | 🟡 中 |
| `--font-size-xl` | `1.125rem` | `1.25rem` | 🟡 中 |
| `--font-size-2xl` | `1.25rem` | `1.5rem` | 🟡 中 |

### 1.2 シャドウ変数の競合
| 変数名 | Tool-IdIndex.css | global.css | 競合レベル |
|--------|----------------|------------|------------|
| `--shadow-sm` | `0 4px 12px oklch(0% 0 0 / 0.1)` | `0 1px 2px oklch(0% 0 0 / 0.05)` | 🟡 中 |
| `--shadow-md` | `0 10px 30px oklch(0% 0 0 / 0.3)` | `0 4px 8px oklch(0% 0 0 / 0.15), 0 2px 4px oklch(0% 0 0 / 0.1)` | 🟡 中 |

## 2. クラス名の競合

### 2.1 ユーティリティクラスの重複
| クラス名 | Tool-IdIndex.css | global.css | 競合レベル |
|----------|----------------|------------|------------|
| `.flex-center` | 定義あり | 未定義 | 🟢 安全 |
| `.flex-between` | 定義あり | 未定義 | 🟢 安全 |
| `.text-gradient` | 定義あり | 未定義 | 🟢 安全 |
| `.glass-effect` | 定義あり | 未定義 | 🟢 安全 |

### 2.2 コンポーネントクラスの重複
| クラス名 | Tool-IdIndex.css | global.css | 競合レベル |
|----------|----------------|------------|------------|
| `.card` | 未定義 | 定義あり | 🟢 安全 |
| `.glass-panel` | 未定義 | 定義あり | 🟢 安全 |

## 3. 影響範囲の分析

### 3.1 影響を受けるコンポーネント
- **ツールページ**: `src/pages/tools/[tool]/index.astro`
- **ツール一覧ページ**: `src/pages/tools/index.astro`
- **グローバルコンポーネント**: 全ページ

### 3.2 視覚的影響
- **色の不一致**: プライマリカラーとテキストカラーの微妙な違い
- **サイズの不一致**: フォントサイズとボーダー半径の違い
- **シャドウの不一致**: 影の強さと範囲の違い

## 4. 段階的解決計画

### Phase 1: 変数の統一（即座に実行可能）
1. **色変数の統一**: global.cssの値を基準に統一
2. **スペーシング変数の確認**: 既に一致しているため変更不要
3. **フォントサイズの統一**: global.cssの値を基準に統一

### Phase 2: ボーダー半径の統一（慎重に実行）
1. **影響範囲の確認**: 既存コンポーネントへの影響をテスト
2. **段階的な移行**: ツールページから開始
3. **グローバル適用**: 問題がないことを確認後、全ページに適用

### Phase 3: シャドウシステムの統一（最終段階）
1. **デザインシステムの確立**: 統一されたシャドウ階層の定義
2. **コンポーネントの更新**: 全コンポーネントのシャドウを統一
3. **パフォーマンス最適化**: 不要なシャドウ定義の削除

## 5. 推奨される即座の対応

### 5.1 緊急対応（Critical）
```css
/* Tool-IdIndex.css の :root セクションを削除 */
/* 代わりに global.css の変数を使用 */
```

### 5.2 段階的対応（Recommended）
1. **変数の名前空間化**: `--tool-` プレフィックスを追加
2. **段階的移行**: 1つずつコンポーネントを更新
3. **テスト**: 各段階でビジュアルリグレッションテストを実行

## 6. リスク評価

### 6.1 高リスク
- **色の変更**: ブランドアイデンティティへの影響
- **フォントサイズの変更**: レイアウトの崩れ

### 6.2 中リスク
- **ボーダー半径の変更**: 視覚的な一貫性への影響
- **シャドウの変更**: デプス感の変化

### 6.3 低リスク
- **スペーシングの変更**: 既に一致しているため影響なし

## 7. 次のステップ

1. **Phase 1の実行**: 色変数とフォントサイズの統一
2. **テスト環境での検証**: 変更の影響を確認
3. **段階的な本番適用**: リスクの低い変更から順次適用
4. **ドキュメントの更新**: 変更内容の記録

---

**注意**: この分析は2025年9月17日時点のものです。コードベースの変更に応じて定期的に更新する必要があります。
